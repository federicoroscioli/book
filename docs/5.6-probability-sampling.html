<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="5.6 Probability Sampling | Introduction to Data Analysis with R" />
<meta property="og:type" content="book" />




<meta name="author" content="Federico Roscioli" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="5.6 Probability Sampling | Introduction to Data Analysis with R">

<title>5.6 Probability Sampling | Introduction to Data Analysis with R</title>

<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="book_assets/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="book_assets/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="book_assets/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="book_assets/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="book_assets/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#preface" id="toc-preface">Preface</a></li>
<li><a href="introduction.html#introduction" id="toc-introduction">Introduction</a></li>
<li class="part"><span><b>I The R code</b></span></li>
<li class="has-sub"><a href="1-installation.html#installation" id="toc-installation"><span class="toc-section-number">1</span> Installation</a>
<ul>
<li><a href="1.1-introductory-activities.html#introductory-activities" id="toc-introductory-activities"><span class="toc-section-number">1.1</span> Introductory activities</a></li>
<li><a href="1.2-visualization-suggestions.html#visualization-suggestions" id="toc-visualization-suggestions"><span class="toc-section-number">1.2</span> Visualization suggestions</a></li>
<li><a href="1.3-the-workspace.html#the-workspace" id="toc-the-workspace"><span class="toc-section-number">1.3</span> The workspace</a></li>
</ul></li>
<li class="has-sub"><a href="2-a-b-c.html#a-b-c" id="toc-a-b-c"><span class="toc-section-number">2</span> A, B, C</a>
<ul>
<li><a href="2.1-the-first-code.html#the-first-code" id="toc-the-first-code"><span class="toc-section-number">2.1</span> The first code</a></li>
<li><a href="2.2-indexing.html#indexing" id="toc-indexing"><span class="toc-section-number">2.2</span> Indexing</a></li>
<li><a href="2.3-the-first-function.html#the-first-function" id="toc-the-first-function"><span class="toc-section-number">2.3</span> The first function</a></li>
<li><a href="2.4-dataset-exploration.html#dataset-exploration" id="toc-dataset-exploration"><span class="toc-section-number">2.4</span> Dataset Exploration</a></li>
<li><a href="2.5-subsetting.html#subsetting" id="toc-subsetting"><span class="toc-section-number">2.5</span> Subsetting</a></li>
<li><a href="2.6-importing-and-exporting-data.html#importing-and-exporting-data" id="toc-importing-and-exporting-data"><span class="toc-section-number">2.6</span> Importing and exporting data</a></li>
<li><a href="2.7-exercises.html#exercises" id="toc-exercises"><span class="toc-section-number">2.7</span> Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="3-data-cleaning.html#data-cleaning" id="toc-data-cleaning"><span class="toc-section-number">3</span> Data Cleaning</a>
<ul>
<li><a href="3.1-variable-names.html#variable-names" id="toc-variable-names"><span class="toc-section-number">3.1</span> Variable Names</a></li>
<li class="has-sub"><a href="3.2-variable-types.html#variable-types" id="toc-variable-types"><span class="toc-section-number">3.2</span> Variable Types</a>
<ul>
<li><a href="3.2-variable-types.html#factor-variables" id="toc-factor-variables"><span class="toc-section-number">3.2.1</span> Factor variables</a></li>
<li><a href="3.2-variable-types.html#dates-and-times" id="toc-dates-and-times"><span class="toc-section-number">3.2.2</span> Dates and times</a></li>
</ul></li>
<li><a href="3.3-row-names.html#row-names" id="toc-row-names"><span class="toc-section-number">3.3</span> Row Names</a></li>
</ul></li>
<li class="has-sub"><a href="4-advanced-data-manipulation-and-plotting.html#advanced-data-manipulation-and-plotting" id="toc-advanced-data-manipulation-and-plotting"><span class="toc-section-number">4</span> Advanced Data Manipulation and Plotting</a>
<ul>
<li><a href="4.1-ifelse.html#ifelse" id="toc-ifelse"><span class="toc-section-number">4.1</span> Ifelse</a></li>
<li><a href="4.2-the-apply-family.html#the-apply-family" id="toc-the-apply-family"><span class="toc-section-number">4.2</span> The Apply family</a></li>
<li><a href="4.3-dplyr.html#dplyr" id="toc-dplyr"><span class="toc-section-number">4.3</span> Dplyr</a></li>
<li><a href="4.4-merging-datasets.html#merging-datasets" id="toc-merging-datasets"><span class="toc-section-number">4.4</span> Merging datasets</a></li>
<li><a href="4.5-melting-vs-transposing.html#melting-vs-transposing" id="toc-melting-vs-transposing"><span class="toc-section-number">4.5</span> Melting vs Transposing</a></li>
<li><a href="4.6-ggplot2.html#ggplot2" id="toc-ggplot2"><span class="toc-section-number">4.6</span> Ggplot2</a></li>
<li><a href="4.7-exercises-1.html#exercises-1" id="toc-exercises-1"><span class="toc-section-number">4.7</span> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Statistical Analysis</b></span></li>
<li class="has-sub"><a href="5-exploratory-data-analysis.html#exploratory-data-analysis" id="toc-exploratory-data-analysis"><span class="toc-section-number">5</span> Exploratory Data Analysis</a>
<ul>
<li><a href="5.1-central-tendency-measures.html#central-tendency-measures" id="toc-central-tendency-measures"><span class="toc-section-number">5.1</span> Central Tendency Measures</a></li>
<li><a href="5.2-variability-measures.html#variability-measures" id="toc-variability-measures"><span class="toc-section-number">5.2</span> Variability Measures</a></li>
<li><a href="5.3-inequality-measures.html#inequality-measures" id="toc-inequality-measures"><span class="toc-section-number">5.3</span> Inequality Measures</a></li>
<li><a href="5.4-data-visualization.html#data-visualization" id="toc-data-visualization"><span class="toc-section-number">5.4</span> Data visualization</a></li>
<li><a href="5.5-scaling-data.html#scaling-data" id="toc-scaling-data"><span class="toc-section-number">5.5</span> Scaling data</a></li>
<li><a href="5.6-probability-sampling.html#probability-sampling" id="toc-probability-sampling"><span class="toc-section-number">5.6</span> Probability Sampling</a></li>
<li><a href="5.7-exercises-2.html#exercises-2" id="toc-exercises-2"><span class="toc-section-number">5.7</span> Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="6-hypothesis-testing.html#hypothesis-testing" id="toc-hypothesis-testing"><span class="toc-section-number">6</span> Hypothesis Testing</a>
<ul>
<li><a href="6.1-probability-distributions.html#probability-distributions" id="toc-probability-distributions"><span class="toc-section-number">6.1</span> Probability Distributions</a></li>
<li><a href="6.2-shapiro-wilk-test.html#shapiro-wilk-test" id="toc-shapiro-wilk-test"><span class="toc-section-number">6.2</span> Shapiro-Wilk Test</a></li>
<li><a href="6.3-one-sample-t-test.html#one-sample-t-test" id="toc-one-sample-t-test"><span class="toc-section-number">6.3</span> One-Sample T-Test</a></li>
<li><a href="6.4-unpaired-two-sample-t-test.html#unpaired-two-sample-t-test" id="toc-unpaired-two-sample-t-test"><span class="toc-section-number">6.4</span> Unpaired Two Sample T-Test</a></li>
<li><a href="6.5-mann-whitney-u-test.html#mann-whitney-u-test" id="toc-mann-whitney-u-test"><span class="toc-section-number">6.5</span> Mann Whitney U Test</a></li>
<li><a href="6.6-paired-sample-t-test.html#paired-sample-t-test" id="toc-paired-sample-t-test"><span class="toc-section-number">6.6</span> Paired Sample T-Test</a></li>
<li><a href="6.7-exercises-3.html#exercises-3" id="toc-exercises-3"><span class="toc-section-number">6.7</span> Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="7-bivariate-analysis.html#bivariate-analysis" id="toc-bivariate-analysis"><span class="toc-section-number">7</span> Bivariate Analysis</a>
<ul>
<li><a href="7.1-correlation.html#correlation" id="toc-correlation"><span class="toc-section-number">7.1</span> Correlation</a></li>
<li><a href="7.2-linear-regression.html#linear-regression" id="toc-linear-regression"><span class="toc-section-number">7.2</span> Linear Regression</a></li>
<li><a href="7.3-logistic-regressions.html#logistic-regressions" id="toc-logistic-regressions"><span class="toc-section-number">7.3</span> Logistic Regressions</a></li>
<li><a href="7.4-exercises-4.html#exercises-4" id="toc-exercises-4"><span class="toc-section-number">7.4</span> Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="8-multivariate-analysis.html#multivariate-analysis" id="toc-multivariate-analysis"><span class="toc-section-number">8</span> Multivariate Analysis</a>
<ul>
<li class="has-sub"><a href="8.1-cluster-analysis.html#cluster-analysis" id="toc-cluster-analysis"><span class="toc-section-number">8.1</span> Cluster Analysis</a>
<ul>
<li><a href="8.1-cluster-analysis.html#hierarchical-clustering" id="toc-hierarchical-clustering"><span class="toc-section-number">8.1.1</span> Hierarchical Clustering</a></li>
<li><a href="8.1-cluster-analysis.html#k-means-clustering" id="toc-k-means-clustering"><span class="toc-section-number">8.1.2</span> K-Means clustering</a></li>
<li><a href="8.1-cluster-analysis.html#the-silhouette-plot" id="toc-the-silhouette-plot"><span class="toc-section-number">8.1.3</span> The silhouette plot</a></li>
</ul></li>
<li><a href="8.2-heatmap.html#heatmap" id="toc-heatmap"><span class="toc-section-number">8.2</span> Heatmap</a></li>
<li><a href="8.3-principal-component-analysis.html#principal-component-analysis" id="toc-principal-component-analysis"><span class="toc-section-number">8.3</span> Principal Component Analysis</a></li>
<li><a href="8.4-classification-and-regression-trees.html#classification-and-regression-trees" id="toc-classification-and-regression-trees"><span class="toc-section-number">8.4</span> Classification And Regression Trees</a></li>
<li class="has-sub"><a href="8.5-composite-indicators.html#composite-indicators" id="toc-composite-indicators"><span class="toc-section-number">8.5</span> Composite Indicators</a>
<ul>
<li><a href="8.5-composite-indicators.html#mazziotta-pareto-index" id="toc-mazziotta-pareto-index"><span class="toc-section-number">8.5.1</span> Mazziotta-Pareto Index</a></li>
<li><a href="8.5-composite-indicators.html#adjusted-mazziotta-pareto-index" id="toc-adjusted-mazziotta-pareto-index"><span class="toc-section-number">8.5.2</span> Adjusted Mazziotta-Pareto Index</a></li>
</ul></li>
<li><a href="8.6-exercises-5.html#exercises-5" id="toc-exercises-5"><span class="toc-section-number">8.6</span> Exercises</a></li>
</ul></li>
<li><a href="final-remarks.html#final-remarks" id="toc-final-remarks">Final Remarks</a></li>
<li><a href="bibliography.html#bibliography" id="toc-bibliography">Bibliography</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="probability-sampling" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Probability Sampling</h2>
<p>Sampling allows statisticians to draw conclusions about a whole by
examining a part. It enables us to estimate characteristics of a
population by directly observing a portion of the entire population.
Researchers are not interested in the sample itself, but in what can be
learned from the survey—and how this information can be applied to the
entire population.</p>
<hr />
<p><strong>Simple Random sampling</strong> is a powerful tool, we can use it to random
subset data, or generate random distributions with precise
characteristics. Each member of a population has an equal chance of
being included in the sample. Also, each combination of members of the
population has an equal chance of composing the sample. Those two
properties are what defines simple random sampling. Simple random
sampling can be done <em>with or without replacement</em>. A sample with
replacement means that there is a possibility that the sampled
observation may be selected twice or more. Usually, the simple random
sampling approach is conducted without replacement because it is more
convenient and gives more precise results.</p>
<p>Simple random sampling is the easiest method of sampling and it is the
most commonly used. Advantages of this technique are that it does not
require any additional information on the sampled unit, nor on the
context (i.e. the geographic area, gender, age, etc…). Also, since
simple random sampling is a simple method and the theory behind it is
well established, standard formulas exist to determine the sample size,
the estimates and so on, and these formulas are easy to use.</p>
<p>On the other hand, by making no use of context information this method
may sometimes result less efficient in equally representing some strata
of the population, particularly for smaller samples. Finally, if we are
planning a survey and not just sampling already collected data, simple
random sampling may result an expensive and unfeasible method for large
populations because all elements must be identified and labeled prior to
sampling. It can also be expensive if personal interviewers are required
since the sample may be geographically spread out across the population.</p>
<p>We can calculate the probability of a given observation being selected.
Since we know the sample size (<span class="math inline">\(n\)</span>) and the total population (<span class="math inline">\(N\)</span>),
calculating the probability of being included in the sample becomes a
simple matter of division (Equation <a href="5.6-probability-sampling.html#eq:srs">(5.15)</a>).</p>
<p><span class="math display" id="eq:srs">\[\begin{equation}
p=\frac{n}{N}*100
\tag{5.15}
\end{equation}\]</span></p>
<p>In R we will use the <code>sample()</code> function. This function requires us to
specify the total population to be sampled (i.e. a vector between 1 and
1 million), comma, the sample size we are interested in, comma, if we
want replacement to happen (<code>TRUE</code>) or not (<code>FALSE</code>).</p>
<p>In order to have a reproducible code (this is one of the main reasons
for using R as our working tools), we want to be able to select the same
random sample over and over. It may sound complex, but it is not. If we
are not able to select the same random sample today and tomorrow, our
analysis will change slightly every time we run the code. In order to
solve this problem, we will use the <code>set.seed()</code> function at the
beginning of our work. In fact by setting the seed, we tell R which set
of random number generator to use. <strong>Please be aware that different
versions of the Random Number Generator will select different samples
given the same seed. If you collaborate with other people, specify the
same version of it</strong> (see the code below)<strong>.</strong></p>
<p>In the code below, run the first line multiple times and you will see
different samples drawn. If instead, you run the set.seed line plus the
sampling, you will have always the same sample. The last line of code,
gives us an example of how to randomly select 4 rows out of the mtcars
dataset (32 rows) using a combination of the indexing system and the
<code>sample()</code> function. In fact, between square brackets there are: a
vector of row numbers (generated by the <code>sample()</code> function), comma
nothing (which means that we want to keep all the columns of the
dataset). You can run just the sample function first to see the
resulting vector (<code>sample(1:32, 4, replace=FALSE)</code>), after this run the
whole line (<code>samp_data &lt;- mtcars[sample(1:32, 4, replace=FALSE),]</code>). The
code subsets the mtcars lines randomly sampled.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="5.6-probability-sampling.html#cb41-1" tabindex="-1"></a><span class="co"># random sampling 4 numbers out of the series from 1 to 32</span></span>
<span id="cb41-2"><a href="5.6-probability-sampling.html#cb41-2" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>, <span class="dv">4</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb41-3"><a href="5.6-probability-sampling.html#cb41-3" tabindex="-1"></a></span>
<span id="cb41-4"><a href="5.6-probability-sampling.html#cb41-4" tabindex="-1"></a><span class="co"># set seed allows us to reproduce the random operations we do locally</span></span>
<span id="cb41-5"><a href="5.6-probability-sampling.html#cb41-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb41-6"><a href="5.6-probability-sampling.html#cb41-6" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>, <span class="dv">4</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb41-7"><a href="5.6-probability-sampling.html#cb41-7" tabindex="-1"></a></span>
<span id="cb41-8"><a href="5.6-probability-sampling.html#cb41-8" tabindex="-1"></a><span class="co"># specifying the Random Number Generator version, allows everyone to have the same sample. </span></span>
<span id="cb41-9"><a href="5.6-probability-sampling.html#cb41-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>, <span class="at">kind =</span> <span class="st">&quot;Mersenne-Twister&quot;</span>, <span class="at">normal.kind =</span>  <span class="st">&quot;Inversion&quot;</span>)</span>
<span id="cb41-10"><a href="5.6-probability-sampling.html#cb41-10" tabindex="-1"></a></span>
<span id="cb41-11"><a href="5.6-probability-sampling.html#cb41-11" tabindex="-1"></a><span class="co"># sampling the random observations selected</span></span>
<span id="cb41-12"><a href="5.6-probability-sampling.html#cb41-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb41-13"><a href="5.6-probability-sampling.html#cb41-13" tabindex="-1"></a>samp_data <span class="ot">&lt;-</span> mtcars[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>, <span class="dv">4</span>, <span class="at">replace=</span><span class="cn">FALSE</span>),]</span></code></pre></div>
<hr />
<p>In <strong>stratified sampling</strong>, the population is divided into homogeneous,
mutually exclusive groups called strata, and then independent samples
are selected from each stratum. Why do we need to create strata? There
are many reasons, the main one being that it can make the sampling
strategy more efficient. In fact, it was mentioned earlier that we need
a larger sample to get a more accurate estimation of a characteristic
that varies greatly from one unit to the other than for a characteristic
that does not. For example, if every person in a population had the same
salary, then a sample of one individual would be enough to get a precise
estimate of the average salary.</p>
<p>This is the idea behind the efficiency gain obtained with
stratification. If we create strata within which units share similar
characteristics (e.g., income) and are considerably different from units
in other strata (e.g., occupation, type of dwelling) then we would only
need a small sample from each stratum to get a precise estimate of total
income for that stratum. Then we could combine these estimates to get a
precise estimate of total income for the whole population. If we were to
use a simple random sampling approach in the whole population without
stratification, the sample would need to be larger than the total of all
stratum samples to get an estimate of total income with the same level
of precision.</p>
<p>Any of the sampling methods mentioned in this section (and others that
exist) can be used to sample within each stratum. The sampling method
and size can vary from one stratum to another, since each stratum
becomes an independent population. When simple random sampling is used
to select the sample within each stratum, the sample design is called
<strong>stratified simple random sampling</strong>. A population can be stratified by
any variable that is available for all units on the sampling frame prior
to sampling (i.e., age, gender, province of residence, income, etc.).</p>
<p>The code below applies a Stratified Simple Random Sampling to the Star
Wars dataset. Using the <code>Dplyr</code> package <span class="citation">(<a href="#ref-wickham2022">Wickham and Bryan 2022</a>)</span>, we are able to
stratify the data by one variable (eye color), and sample randomly 40%
of the available population in each stratum (function <code>sample_frac()</code>),
or 2 observations per stratum (function <code>sample_n()</code>).</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="5.6-probability-sampling.html#cb42-1" tabindex="-1"></a><span class="co"># loading the package and data</span></span>
<span id="cb42-2"><a href="5.6-probability-sampling.html#cb42-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb42-3"><a href="5.6-probability-sampling.html#cb42-3" tabindex="-1"></a></span>
<span id="cb42-4"><a href="5.6-probability-sampling.html#cb42-4" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="5.6-probability-sampling.html#cb42-5" tabindex="-1"></a>        <span class="co"># stratifying by eye color</span></span>
<span id="cb42-6"><a href="5.6-probability-sampling.html#cb42-6" tabindex="-1"></a>        <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="5.6-probability-sampling.html#cb42-7" tabindex="-1"></a>        <span class="co"># setting the sample size</span></span>
<span id="cb42-8"><a href="5.6-probability-sampling.html#cb42-8" tabindex="-1"></a>        <span class="fu">sample_frac</span>(.<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="5.6-probability-sampling.html#cb42-9" tabindex="-1"></a>        ungroup</span>
<span id="cb42-10"><a href="5.6-probability-sampling.html#cb42-10" tabindex="-1"></a></span>
<span id="cb42-11"><a href="5.6-probability-sampling.html#cb42-11" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="5.6-probability-sampling.html#cb42-12" tabindex="-1"></a>        <span class="co"># stratifying by eye color</span></span>
<span id="cb42-13"><a href="5.6-probability-sampling.html#cb42-13" tabindex="-1"></a>        <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb42-14"><a href="5.6-probability-sampling.html#cb42-14" tabindex="-1"></a>        <span class="co"># setting the sample size</span></span>
<span id="cb42-15"><a href="5.6-probability-sampling.html#cb42-15" tabindex="-1"></a>        <span class="fu">sample_n</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="5.6-probability-sampling.html#cb42-16" tabindex="-1"></a>        ungroup</span></code></pre></div>
<p> </p>
<p> </p>
<p> </p>
</div>
<h3>Bibliography</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-wickham2022" class="csl-entry">
Wickham, Hadley, and Jennifer Bryan. 2022. <span>“Readxl: Read Excel Files.”</span> <a href="https://readxl.tidyverse.org">https://readxl.tidyverse.org</a>.
</div>
</div>
<p style="text-align: center;">
<a href="5.5-scaling-data.html"><button class="btn btn-default">Previous</button></a>
<a href="5.7-exercises-2.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
